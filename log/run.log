2025-12-14 01:44:26 - __main__ - INFO - 
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO - ANKLE ALIGNMENT MODEL TRAINING
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO - Started at: 2025-12-14 01:44:26
2025-12-14 01:44:26 - __main__ - INFO - 
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO - TRAINING CONFIGURATION
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO -   Device: cpu
2025-12-14 01:44:26 - __main__ - INFO -   Epochs: 100
2025-12-14 01:44:26 - __main__ - INFO -   Batch Size: 32
2025-12-14 01:44:26 - __main__ - INFO -   Learning Rate: 0.0001
2025-12-14 01:44:26 - __main__ - INFO -   Weight Decay: 0.0001
2025-12-14 01:44:26 - __main__ - INFO -   Early Stopping Patience: 10
2025-12-14 01:44:26 - __main__ - INFO -   Freeze Epochs: 0
2025-12-14 01:44:26 - __main__ - INFO -   Dropout: 0.3
2025-12-14 01:44:26 - __main__ - INFO -   Image Size: 224x224
2025-12-14 01:44:26 - __main__ - INFO -   Augmentation Enabled: True
2025-12-14 01:44:26 - __main__ - INFO -   Number of Classes: 3
2025-12-14 01:44:26 - __main__ - INFO - 
2025-12-14 01:44:26 - __main__ - INFO - 
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO - DATA LOADING
2025-12-14 01:44:26 - __main__ - INFO - ======================================================================
2025-12-14 01:44:26 - __main__ - INFO - Loading and preprocessing datasets...
2025-12-14 01:44:26 - __main__ - INFO - Loaded 216 samples from /app/data/processed/train
2025-12-14 01:44:26 - __main__ - INFO - Loading images to memory...
2025-12-14 01:44:27 - __main__ - INFO - Loaded 47 samples from /app/data/processed/val
2025-12-14 01:44:27 - __main__ - INFO - Loading images to memory...
2025-12-14 01:44:27 - __main__ - INFO - Loaded 47 samples from /app/data/processed/test
2025-12-14 01:44:27 - __main__ - INFO - Loading images to memory...
2025-12-14 01:44:28 - __main__ - INFO - 
2025-12-14 01:44:28 - __main__ - INFO - ======================================================================
2025-12-14 01:44:28 - __main__ - INFO - DATA SUMMARY
2025-12-14 01:44:28 - __main__ - INFO - ======================================================================
2025-12-14 01:44:28 - __main__ - INFO -   Total samples: 310
2025-12-14 01:44:28 - __main__ - INFO -   Training samples:      216 (69.7%)
2025-12-14 01:44:28 - __main__ - INFO -   Validation samples:     47 (15.2%)
2025-12-14 01:44:28 - __main__ - INFO -   Test samples:           47 (15.2%)
2025-12-14 01:44:28 - __main__ - INFO - 
2025-12-14 01:44:28 - __main__ - INFO -   Class Distribution (Training):
2025-12-14 01:44:28 - __main__ - INFO -     Pronation: 87 (40.3%)
2025-12-14 01:44:28 - __main__ - INFO -     Neutral: 95 (44.0%)
2025-12-14 01:44:28 - __main__ - INFO -     Supination: 34 (15.7%)
2025-12-14 01:44:28 - __main__ - INFO - 
2025-12-14 01:44:28 - __main__ - INFO - Data loading complete.
2025-12-14 01:44:30 - __main__ - INFO - 
2025-12-14 01:44:30 - __main__ - INFO - ======================================================================
2025-12-14 01:44:30 - __main__ - INFO - MODEL ARCHITECTURE
2025-12-14 01:44:30 - __main__ - INFO - ======================================================================
2025-12-14 01:44:30 - __main__ - INFO - Model Class: ResNetTransfer
2025-12-14 01:44:30 - __main__ - INFO - 
2025-12-14 01:44:30 - __main__ - INFO - Parameter Summary:
2025-12-14 01:44:30 - __main__ - INFO -   Total parameters:           11,178,051
2025-12-14 01:44:30 - __main__ - INFO -   Trainable parameters:       11,178,051
2025-12-14 01:44:30 - __main__ - INFO -   Non-trainable parameters:            0
2025-12-14 01:44:30 - __main__ - INFO - 
2025-12-14 01:44:30 - __main__ - INFO - Layer Summary:
2025-12-14 01:44:30 - __main__ - INFO -   backbone: 11,178,051 params (11,178,051 trainable)
2025-12-14 01:44:30 - __main__ - INFO - 
2025-12-14 01:44:30 - __main__ - INFO - Class weights:
2025-12-14 01:44:30 - __main__ - INFO -   Pronation: 0.670 (count: 87)
2025-12-14 01:44:30 - __main__ - INFO -   Neutral: 0.614 (count: 95)
2025-12-14 01:44:30 - __main__ - INFO -   Supination: 1.716 (count: 34)
2025-12-14 01:44:30 - __main__ - INFO - 
2025-12-14 01:44:30 - __main__ - INFO - ======================================================================
2025-12-14 01:44:30 - __main__ - INFO - TRAINING PROGRESS
2025-12-14 01:44:30 - __main__ - INFO - ======================================================================
2025-12-14 01:44:44 - __main__ - INFO - Epoch [001/100] Train Loss: 1.1223 | Train Acc: 0.4444 | Val Loss: 1.2724 | Val Acc: 0.2340 | LR: 1.00e-04 *BEST*
2025-12-14 01:44:59 - __main__ - INFO - Epoch [002/100] Train Loss: 0.8305 | Train Acc: 0.6157 | Val Loss: 1.3255 | Val Acc: 0.3617 | LR: 1.00e-04
2025-12-14 01:45:12 - __main__ - INFO - Epoch [003/100] Train Loss: 0.6996 | Train Acc: 0.6991 | Val Loss: 1.3112 | Val Acc: 0.3617 | LR: 1.00e-04
2025-12-14 01:45:26 - __main__ - INFO - Epoch [004/100] Train Loss: 0.5967 | Train Acc: 0.7407 | Val Loss: 1.2679 | Val Acc: 0.3617 | LR: 1.00e-04 *BEST*
2025-12-14 01:45:41 - __main__ - INFO - Epoch [005/100] Train Loss: 0.4953 | Train Acc: 0.7824 | Val Loss: 1.2811 | Val Acc: 0.4043 | LR: 1.00e-04
2025-12-14 01:45:56 - __main__ - INFO - Epoch [006/100] Train Loss: 0.3574 | Train Acc: 0.8611 | Val Loss: 1.2808 | Val Acc: 0.4255 | LR: 1.00e-04
2025-12-14 01:46:10 - __main__ - INFO - Epoch [007/100] Train Loss: 0.2866 | Train Acc: 0.8981 | Val Loss: 1.3695 | Val Acc: 0.4255 | LR: 1.00e-04
2025-12-14 01:46:24 - __main__ - INFO - Epoch [008/100] Train Loss: 0.2327 | Train Acc: 0.9120 | Val Loss: 1.3401 | Val Acc: 0.4468 | LR: 5.00e-05
2025-12-14 01:46:39 - __main__ - INFO - Epoch [009/100] Train Loss: 0.1945 | Train Acc: 0.9444 | Val Loss: 1.3305 | Val Acc: 0.4255 | LR: 5.00e-05
2025-12-14 01:46:54 - __main__ - INFO - Epoch [010/100] Train Loss: 0.1863 | Train Acc: 0.9259 | Val Loss: 1.3674 | Val Acc: 0.3830 | LR: 5.00e-05
2025-12-14 01:47:09 - __main__ - INFO - Epoch [011/100] Train Loss: 0.1435 | Train Acc: 0.9537 | Val Loss: 1.4142 | Val Acc: 0.4043 | LR: 5.00e-05
2025-12-14 01:47:22 - __main__ - INFO - Epoch [012/100] Train Loss: 0.1035 | Train Acc: 0.9722 | Val Loss: 1.4294 | Val Acc: 0.3830 | LR: 2.50e-05
2025-12-14 01:47:36 - __main__ - INFO - Epoch [013/100] Train Loss: 0.1039 | Train Acc: 0.9722 | Val Loss: 1.4406 | Val Acc: 0.3830 | LR: 2.50e-05
2025-12-14 01:47:50 - __main__ - INFO - Epoch [014/100] Train Loss: 0.1008 | Train Acc: 0.9722 | Val Loss: 1.4644 | Val Acc: 0.3830 | LR: 2.50e-05
2025-12-14 01:47:50 - __main__ - INFO - 
Early stopping triggered after 14 epochs
2025-12-14 01:47:52 - __main__ - INFO - 
2025-12-14 01:47:52 - __main__ - INFO - ======================================================================
2025-12-14 01:47:52 - __main__ - INFO - FINAL EVALUATION RESULTS
2025-12-14 01:47:52 - __main__ - INFO - ======================================================================
2025-12-14 01:47:52 - __main__ - INFO - Test Set Metrics:
2025-12-14 01:47:52 - __main__ - INFO -   Test Loss: 1.1480
2025-12-14 01:47:52 - __main__ - INFO -   Test Accuracy: 0.5745
2025-12-14 01:47:52 - __main__ - INFO -   Precision (weighted): 0.6239
2025-12-14 01:47:52 - __main__ - INFO -   Recall (weighted): 0.5745
2025-12-14 01:47:52 - __main__ - INFO -   F1-Score (weighted): 0.5899
2025-12-14 01:47:52 - __main__ - INFO -   Accuracy (Pronation): 0.5263
2025-12-14 01:47:52 - __main__ - INFO -   Accuracy (Neutral): 0.6667
2025-12-14 01:47:52 - __main__ - INFO -   Accuracy (Supination): 0.4286
2025-12-14 01:47:52 - __main__ - INFO - 
2025-12-14 01:47:52 - __main__ - INFO - Confusion Matrix:
2025-12-14 01:47:52 - __main__ - INFO -     10     5     4
2025-12-14 01:47:52 - __main__ - INFO -      2    14     5
2025-12-14 01:47:52 - __main__ - INFO -      2     2     3
2025-12-14 01:47:52 - __main__ - INFO - 
2025-12-14 01:47:52 - __main__ - INFO - Classification Report:
2025-12-14 01:47:52 - __main__ - INFO -                 precision    recall  f1-score   support
2025-12-14 01:47:52 - __main__ - INFO -      Pronation       0.71      0.53      0.61        19
2025-12-14 01:47:52 - __main__ - INFO -        Neutral       0.67      0.67      0.67        21
2025-12-14 01:47:52 - __main__ - INFO -     Supination       0.25      0.43      0.32         7
2025-12-14 01:47:52 - __main__ - INFO -       accuracy                           0.57        47
2025-12-14 01:47:52 - __main__ - INFO -      macro avg       0.54      0.54      0.53        47
2025-12-14 01:47:52 - __main__ - INFO -   weighted avg       0.62      0.57      0.59        47
2025-12-14 01:47:52 - __main__ - INFO - 
2025-12-14 01:47:52 - __main__ - INFO - 
Final model saved to: /app/models/final_model.pth
2025-12-14 01:47:52 - __main__ - INFO - Training history saved to: /app/models/training_history.json
2025-12-14 01:47:52 - __main__ - INFO - 
2025-12-14 01:47:52 - __main__ - INFO - ======================================================================
2025-12-14 01:47:52 - __main__ - INFO - TRAINING COMPLETE
2025-12-14 01:47:52 - __main__ - INFO - ======================================================================
2025-12-14 01:47:52 - __main__ - INFO - Completed at: 2025-12-14 01:47:52
2025-12-14 01:47:52 - __main__ - INFO - Total epochs trained: 14
2025-12-14 01:47:52 - __main__ - INFO - Best Validation Loss: 1.2679
2025-12-14 01:47:52 - __main__ - INFO - Best Validation Accuracy: 0.3617
2025-12-14 01:47:52 - __main__ - INFO - Final Test Accuracy: 0.5745
2025-12-14 01:47:52 - __main__ - INFO - Final Test F1-Score: 0.5899
2025-12-14 01:47:52 - __main__ - INFO - Model saved to: /app/models/final_model.pth
2025-12-14 01:47:52 - __main__ - INFO - 
[2025-12-14 01:47:53] 
[2025-12-14 01:47:53] ========================================
[2025-12-14 01:47:53] STEP 3/5: MODEL EVALUATION
[2025-12-14 01:47:53] ========================================
2025-12-14 01:47:56 - __main__ - INFO - 
2025-12-14 01:47:56 - __main__ - INFO - ======================================================================
2025-12-14 01:47:56 - __main__ - INFO - ANKLE ALIGNMENT MODEL EVALUATION
2025-12-14 01:47:56 - __main__ - INFO - ======================================================================
2025-12-14 01:47:56 - __main__ - INFO - Started at: 2025-12-14 01:47:56
2025-12-14 01:47:56 - __main__ - INFO - Loading model from: /app/models/final_model.pth
2025-12-14 01:47:56 - __main__ - INFO - Model loaded successfully
2025-12-14 01:47:56 - __main__ - INFO -   Training epochs: 14
2025-12-14 01:47:56 - __main__ - INFO -   Best val accuracy: 0.3617
2025-12-14 01:47:56 - __main__ - INFO - 
Loading test data...
2025-12-14 01:47:56 - __main__ - INFO - Test samples: 47
2025-12-14 01:47:56 - __main__ - INFO - 
Running evaluation...
2025-12-14 01:47:57 - __main__ - INFO - 
Computing metrics...
2025-12-14 01:47:57 - __main__ - INFO - 
2025-12-14 01:47:57 - __main__ - INFO - ======================================================================
2025-12-14 01:47:57 - __main__ - INFO - FINAL EVALUATION RESULTS
2025-12-14 01:47:57 - __main__ - INFO - ======================================================================
2025-12-14 01:47:57 - __main__ - INFO - Test Set Metrics:
2025-12-14 01:47:57 - __main__ - INFO -   Accuracy: 0.5745
2025-12-14 01:47:57 - __main__ - INFO -   Precision (macro): 0.5437
2025-12-14 01:47:57 - __main__ - INFO -   Recall (macro): 0.5405
2025-12-14 01:47:57 - __main__ - INFO -   F1-Score (macro): 0.5295
2025-12-14 01:47:57 - __main__ - INFO -   Precision (weighted): 0.6239
2025-12-14 01:47:57 - __main__ - INFO -   Recall (weighted): 0.5745
2025-12-14 01:47:57 - __main__ - INFO -   F1-Score (weighted): 0.5899
2025-12-14 01:47:57 - __main__ - INFO -   Accuracy (Pronation): 0.5263
2025-12-14 01:47:57 - __main__ - INFO -   F1-Score (Pronation): 0.6061
2025-12-14 01:47:57 - __main__ - INFO -   AUC (Pronation): 0.7406
2025-12-14 01:47:57 - __main__ - INFO -   Accuracy (Neutral): 0.6667
2025-12-14 01:47:57 - __main__ - INFO -   F1-Score (Neutral): 0.6667
2025-12-14 01:47:57 - __main__ - INFO -   AUC (Neutral): 0.7308
2025-12-14 01:47:57 - __main__ - INFO -   Accuracy (Supination): 0.4286
2025-12-14 01:47:57 - __main__ - INFO -   F1-Score (Supination): 0.3158
2025-12-14 01:47:57 - __main__ - INFO -   AUC (Supination): 0.7000
2025-12-14 01:47:57 - __main__ - INFO - 
2025-12-14 01:47:57 - __main__ - INFO - Confusion Matrix:
2025-12-14 01:47:57 - __main__ - INFO -     10     5     4
2025-12-14 01:47:57 - __main__ - INFO -      2    14     5
2025-12-14 01:47:57 - __main__ - INFO -      2     2     3
2025-12-14 01:47:57 - __main__ - INFO - 
2025-12-14 01:47:57 - __main__ - INFO - Classification Report:
2025-12-14 01:47:57 - __main__ - INFO -                 precision    recall  f1-score   support
2025-12-14 01:47:57 - __main__ - INFO -      Pronation       0.71      0.53      0.61        19
2025-12-14 01:47:57 - __main__ - INFO -        Neutral       0.67      0.67      0.67        21
2025-12-14 01:47:57 - __main__ - INFO -     Supination       0.25      0.43      0.32         7
2025-12-14 01:47:57 - __main__ - INFO -       accuracy                           0.57        47
2025-12-14 01:47:57 - __main__ - INFO -      macro avg       0.54      0.54      0.53        47
2025-12-14 01:47:57 - __main__ - INFO -   weighted avg       0.62      0.57      0.59        47
2025-12-14 01:47:57 - __main__ - INFO - 
2025-12-14 01:47:57 - __main__ - INFO - Per-Class Details:
2025-12-14 01:47:57 - __main__ - INFO -   Pronation:
2025-12-14 01:47:57 - __main__ - INFO -     Precision: 0.7143
2025-12-14 01:47:57 - __main__ - INFO -     Recall:    0.5263
2025-12-14 01:47:57 - __main__ - INFO -     F1 Score:  0.6061
2025-12-14 01:47:57 - __main__ - INFO -     Support:   19
2025-12-14 01:47:57 - __main__ - INFO -     AUC:       0.7406
2025-12-14 01:47:57 - __main__ - INFO -   Neutral:
2025-12-14 01:47:57 - __main__ - INFO -     Precision: 0.6667
2025-12-14 01:47:57 - __main__ - INFO -     Recall:    0.6667
2025-12-14 01:47:57 - __main__ - INFO -     F1 Score:  0.6667
2025-12-14 01:47:57 - __main__ - INFO -     Support:   21
2025-12-14 01:47:57 - __main__ - INFO -     AUC:       0.7308
2025-12-14 01:47:57 - __main__ - INFO -   Supination:
2025-12-14 01:47:57 - __main__ - INFO -     Precision: 0.2500
2025-12-14 01:47:57 - __main__ - INFO -     Recall:    0.4286
2025-12-14 01:47:57 - __main__ - INFO -     F1 Score:  0.3158
2025-12-14 01:47:57 - __main__ - INFO -     Support:   7
2025-12-14 01:47:57 - __main__ - INFO -     AUC:       0.7000
2025-12-14 01:47:57 - __main__ - INFO - 
Generating visualizations...
2025-12-14 01:47:58 - __main__ - INFO - Confusion matrix saved to: /app/models/evaluation/confusion_matrix.png
2025-12-14 01:47:58 - __main__ - INFO - ROC curves saved to: /app/models/evaluation/roc_curves.png
2025-12-14 01:47:58 - __main__ - INFO - Precision-recall curves saved to: /app/models/evaluation/precision_recall_curves.png
2025-12-14 01:47:58 - __main__ - INFO - Per-class metrics saved to: /app/models/evaluation/per_class_metrics.png
2025-12-14 01:48:00 - __main__ - INFO - Misclassification visualization saved
2025-12-14 01:48:00 - __main__ - INFO - Evaluation report saved to: /app/models/evaluation/evaluation_report.json
2025-12-14 01:48:00 - __main__ - INFO - 
2025-12-14 01:48:00 - __main__ - INFO - ======================================================================
2025-12-14 01:48:00 - __main__ - INFO - EVALUATION COMPLETE
2025-12-14 01:48:00 - __main__ - INFO - ======================================================================
2025-12-14 01:48:00 - __main__ - INFO - Completed at: 2025-12-14 01:48:00
2025-12-14 01:48:00 - __main__ - INFO - 
2025-12-14 01:48:00 - __main__ - INFO - Summary:
2025-12-14 01:48:00 - __main__ - INFO -   Test Accuracy:      0.5745
2025-12-14 01:48:00 - __main__ - INFO -   F1 Score (macro):   0.5295
2025-12-14 01:48:00 - __main__ - INFO -   F1 Score (weighted):0.5899
2025-12-14 01:48:00 - __main__ - INFO -   Misclassified:      20/47 (42.6%)
2025-12-14 01:48:00 - __main__ - INFO - 
2025-12-14 01:48:00 - __main__ - INFO - Results saved to: /app/models/evaluation
[2025-12-14 01:48:01] 
[2025-12-14 01:48:01] ========================================
[2025-12-14 01:48:01] STEP 4/5: DEMO INFERENCE
[2025-12-14 01:48:01] ========================================
2025-12-14 01:48:03 - __main__ - INFO - ============================================================
2025-12-14 01:48:03 - __main__ - INFO - ANKLE ALIGNMENT INFERENCE
2025-12-14 01:48:03 - __main__ - INFO - ============================================================
2025-12-14 01:48:03 - __main__ - INFO - Loading model from: /app/models/final_model.pth
2025-12-14 01:48:04 - __main__ - INFO - Model loaded successfully
2025-12-14 01:48:04 - __main__ - INFO -   Classes: ['Pronation', 'Neutral', 'Supination']
2025-12-14 01:48:04 - __main__ - INFO -   Image size: (224, 224)x(224, 224)
2025-12-14 01:48:04 - __main__ - INFO - 
Processing directory: data/processed/test
2025-12-14 01:48:04 - __main__ - INFO - Found 47 images in data/processed/test
2025-12-14 01:48:05 - __main__ - INFO - 
Inference complete!
[2025-12-14 01:48:06] 
[2025-12-14 01:48:06] ========================================
[2025-12-14 01:48:06] STEP 5/5: STARTING WEB APPLICATION
[2025-12-14 01:48:06] ========================================
[2025-12-14 01:48:06] Gradio app starting on port 7860...
[2025-12-14 01:48:06] Access the app at: http://localhost:7860
[2025-12-14 01:48:06] 
2025-12-14 01:48:10 - __main__ - INFO - ============================================================
2025-12-14 01:48:10 - __main__ - INFO - ANKLE ALIGNMENT WEB APPLICATION
2025-12-14 01:48:10 - __main__ - INFO - ============================================================
2025-12-14 01:48:10 - __main__ - INFO - Loading model...
2025-12-14 01:48:10 - __main__ - INFO - Loading model from: /app/models/final_model.pth
2025-12-14 01:48:10 - __main__ - INFO - Model loaded successfully
2025-12-14 01:48:10 - __main__ - INFO - Classifier initialized on cpu
2025-12-14 01:48:11 - __main__ - INFO - Starting server on port 7860...
2025-12-14 01:48:11 - __main__ - INFO - Share link: Disabled
